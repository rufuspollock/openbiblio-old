====================================================
Installation of Bibliographica with Virtuoso backend
====================================================

Initial Steps:
--------------

Get open biblio and setup virtualenv::

    $ hg clone https://bitbucket.org/okfn/openbiblio
    $ cd openbiblio/
    $ virtualenv .
    $ source bin/activate

Install requirements
--------------------

Create ini files for openbiblio and configure::

    $ cd ../
    $ python setup.py develop
    $ paster make-config openbiblio development.ini

Check that the information within development.ini makes sense - you may need to comment out the 
Sleepycat RDF back end and uncomment the Virtuoso backend lines.

Install virtuoso
----------------

OSX macports::

    $ sudo port install virtuoso

- OR -

Ubuntu/debian::

    $ apt-get install virtuoso-opensource

It should ask for a password for the 'DBA' for the instance.

Once this has installed, you can check to see if the instance is working by logging into 
http://localhost:8890/conductor/ and seeing if you can access the options provided.

Install ODBC packages to be able to talk to Virtuoso programatically
--------------------------------------------------------------------

Ubuntu/debian::

    $ apt-get install unixodbc-dev
    $ apt-get install libvirtodbc0

Install python client library (requires special pyodbc and gcc)::

    $ pip install http://eris.okfn.org/ww/2010/10/pyodbc-spasql/pyodbc-2.1.8-virtuoso.tar.gz
    $ pip install virtuoso

Configure ODBC::

    ~/.odbc.ini

Edit the above file so it looks like::

    [VOS]
    Description     = Virtuoso
    Driver          = /usr/lib/odbc/virtodbc.so
    Servername      = localhost
    Port            = 1111
    UserName        = dba


Then run the following scrips:
https://bitbucket.org/okfn/jiscobib/src/tip/sql/virtuoso-fts.sql
http://eris.okfn.org/ww/virtuoso_config.sql

Configure virtuoso
------------------

Locate virtuoso.ini On OSX/Macports it is at /opt/local/var/lib/virtuoso/db/virtuoso.ini::

    $ vim virtuoso.ini

Then comment out everything under [Plugins]::

    $ mkdir ~/virtuoso

Final setup for openbiblio
--------------------------

[not sure I needed this or did this... Ben]::

    paster setup-app development.ini

Add some data!
--------------

From within the python virtualenv, run the following command to pull in data from a remote URL and
add it as a graph::

    $ ordf -c development.ini -s --noprov --nocs http://bnb.bibliographica.org/entry/GB5001806

Create indexes in virtuoso (Optional)
-------------------------------------

    $ isql
